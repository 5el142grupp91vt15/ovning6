#include "libcomponent.h"
#include <float.h>
#include <math.h>

static float E12[130] = {
	820000000,680000000,560000000,470000000,390000000,330000000,270000000,220000000,180000000,150000000,120000000,100000000,
	82000000,68000000,56000000,47000000,39000000,33000000,27000000,22000000,18000000,15000000,12000000,10000000,
	8200000,6800000,5600000,4700000,3900000,3300000,2700000,2200000,1800000,1500000,1200000,1000000,
	820000,680000,560000,470000,390000,330000,270000,220000,180000,150000,120000,100000,
	82000,68000,56000,47000,39000,33000,27000,22000,18000,15000,12000,10000,
	8200,6800,5600,4700,3900,3300,2700,2200,1800,1500,1200,1000,
	820,680,560,470,390,330,270,220,180,150,120,100,
	82.0,68.0,56.0,47.0,39.0,33.0,27.0,22.0,18.0,15.0,12.0,10.0,
	.2,6.8,5.6,4.7,3.9,3.3,2.7,2.2,1.8,1.5,1.2,1.0,
	0.82,0.68,0.56,0.47,0.39,0.33,0.27,0.22,0.18,0.15,0.12,0.1,
	.0
};

int e_resistance(float orig_resistance, float *res_array)
{
	int N = 121;
	int idx[3] = {0};
	float err = FLT_MAX;
	float err_t = FLT_MAX;
	int exit_search = 0;
	
	int i,j,k = 0;
	for(i = 0; i < N; i++)  {
		for(j = 0; j < N; j++)  {
			for(k = 0; k < N; k++)  {
				err_t = fabs(orig_resistance-E12[i]-E12[j]-E12[k]);
				if(err_t < err) {
					idx[0] = i;
					idx[1] = j;
					idx[2] = k;
					err = err_t;
				}
				if(err == 0.0) {
					exit_search = 1;
					break;
				}
			}
			if(exit_search) {
				break;
			}
		}
		if(exit_search) {
			break;
		}
	}
		
	int c = 0;
	for(i = 0; i < 3; i++) {
		c += E12[idx[i]] != 0.0;
	}
	
	res_array[0] = E12[idx[0]];	
	res_array[1] = E12[idx[1]];	
	res_array[2] = E12[idx[2]];	

	return c;
}
